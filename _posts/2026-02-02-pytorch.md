---
title: "Pytorch note"
date: 2025-02-02
categories: [Python, PyTorch]
tags: [python, pyTorch]     # TAG names should always be lowercase
---

## Before begin
### In PyTorch, they call all 1D, 2D, 3D a tensor.

---

## 1. Tensor Creation

### From Python List
You can create a tensor directly from a standard Python list.

```python
import torch
import numpy as np

list_data = [[10, 20], [30, 40]]

# Create tensor from list
tensor1 = torch.Tensor(list_data)

print(tensor1)
# tensor([[10., 20.],
#         [30., 40.]])

# Check attributes
print(f"shape: {tensor1.shape}")   # Shape of the tensor
print(f"dtype: {tensor1.dtype}")   # Data type (default is float32)
print(f"device: {tensor1.device}") # Device location (cpu/cuda)

```

{: .prompt-tip }

> **Using GPU**: If `torch.cuda.is_available()` returns `True`, you can move the tensor to the GPU memory using `.to("cuda")`.

### From NumPy

When converting a NumPy array to a tensor, use `torch.from_numpy()`.

```python
numpy_data = np.array(list_data)
tensor2 = torch.from_numpy(numpy_data)

print(f"dtype: {tensor2.dtype}") 
# Result: torch.int64 (Inherits the integer type from NumPy)

```

{: .prompt-warning }

> **Watch out for Data Types**: Tensors created from NumPy integer arrays default to `int64`. Since Deep Learning models typically require floating-point numbers, it is essential to cast the type using `.float()`.

```python
# Cast to float during creation
tensor2 = torch.from_numpy(numpy_data).float()

```

### Random Data Generation

These functions are frequently used for initializing weights in neural networks.

| Function | Description | Distribution |
| --- | --- | --- |
| `torch.rand(m, n)` | Generates values between 0 and 1 | Uniform Distribution |
| `torch.randn(m, n)` | Generates values with Mean=0, Var=1 | Normal (Gaussian) Distribution |

---

## 2. Tensor Operations

### Indexing & Slicing

Used to access specific elements or extract sub-tensors.

**Base Data (`tensor6`, `tensor7`)**

| `tensor6` | 1 | 2 | 3 |
| --- | --- | --- | --- |
| **Row 1** | 4 | 5 | 6 |

| `tensor7` | 7 | 8 | 9 |
| --- | --- | --- | --- |
| **Row 1** | 10 | 11 | 12 |

**Slicing Examples**

```python
# 1. All data in the first row
print(tensor6[0]) 
# [1., 2., 3.]

# 2. All rows, from the second column to the end
print(tensor6[:, 1:]) 
# [[2., 3.],
#  [5., 6.]]

# 3. Intersection: Rows 0~1 and Columns 0~1
print(tensor7[0:2, 0:-1])
# [[ 7.,  8.],
#  [10., 11.]]

```

### Multiplication: Element-wise vs Matrix Multiplication

It is important to distinguish between simple element-wise multiplication and matrix multiplication (dot product).

1. **`mul` (Element-wise Product)**: Multiplies elements at the same position. (Same as `*` operator).
2. **`matmul` (Matrix Multiplication)**: Performs matrix multiplication. (Same as `@` operator).

```python
# Element-wise product
tensor8 = tensor6.mul(tensor7) 
# Result shape: (2, 3) remains the same

# Matrix Multiplication (Error Case)
# tensor6(2x3) @ tensor7(2x3) -> Shape Mismatch Error!
# The columns of the first matrix (3) must match the rows of the second (2).

```

{: .prompt-info }

> **Reshape (`view`)**: To perform matrix multiplication, we need to change the shape of `tensor7` to `(3, 2)`.

```python
# Perform matrix multiplication after reshaping
# (2, 3) @ (3, 2) -> (2, 2) result
tensor9 = tensor6.matmul(tensor7.view(3, 2))

```

---

## 3. Tensor Concatenation

You can join tensors using `torch.cat`. The `dim` parameter determines the direction of concatenation.

### `dim=0` (Vertical Concatenation)

Stacks tensors vertically (along the rows). The number of columns remains the same.

```python
torch.cat([tensor6, tensor7], dim=0)

```

| Result | Col 0 | Col 1 | Col 2 |
| --- | --- | --- | --- |
| **t6** | 1 | 2 | 3 |
| **t6** | 4 | 5 | 6 |
| **t7** | 7 | 8 | 9 |
| **t7** | 10 | 11 | 12 |

### `dim=1` (Horizontal Concatenation)

Stacks tensors horizontally (along the columns). The number of rows remains the same.

```python
torch.cat([tensor6, tensor7], dim=1)

```

| Result | t6 | t6 | t6 | t7 | t7 | t7 |
| --- | --- | --- | --- | --- | --- | --- |
| **Row 0** | 1 | 2 | 3 | 7 | 8 | 9 |
| **Row 1** | 4 | 5 | 6 | 10 | 11 | 12 |

```

